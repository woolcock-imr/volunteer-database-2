<div id=page__ID>
	<div id=panel__ID class="container-fluid" style='max-width:1000px'>
		<div class="text-left panel__ID">
			<h3>Registration Form</h3>
    	  	  <hr style='border-top:1px solid #fff;'></hr>
              <div class="row row__ID">
                  <div class="col-sm control-group" >
                      Email
                      <input class="form-control" type=email id=Email__ID placeholder='Email (this will be used as you login)' />
                      Password
                      <input  class="form-control" type=password id=Registration_Password__ID placeholder="Password" />
                      First Name
                      <input type="text" class="form-control" id="First_Name__ID" name="First_Name__ID" placeholder="First Name">
                      Last Name
                      <input type="text" class="form-control" id="Last_Name__ID" name="Last_Name__ID" placeholder="Last Name">
                      Phone
                      <input type="text" class="form-control" id=Phone__ID name="Phone__ID" placeholder="Phone">
                      Postcode
                      <input type="text" class="form-control" id=Postcode__ID name="Postcode__ID" placeholder="Postcode">
                      Gender
                      <select class="form-control" id=Gender__ID Name=Gender__ID placeholder="Gender">
                          <option value='' >...</option>
                          <option value='Male' >Male</option>
                          <option value='Female' >Female</option>
                          <option >Indeterminate/Intersex/Unspecified</option>
                      </select>
                      Year of Birth
                      <input type="text" class="form-control" id=Year_of_Birth__ID name="Year_of_Birth__ID" placeholder="Year of Birth (YYYY)">

                  </div>

                  <div class="col-sm control-group">
                      <label class="control control-checkbox"><span id=xquest__ID>I would like to participate in medical research and agree to be contacted for more information</span>
                          <input type="checkbox" name="Medical_Research" id=Medical_Research__ID value='medical research'>
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox"> <span id=xquest__ID>I would like to receive updates, including the latest medical findings and break-throughs in respiratory and sleep research, from the Woolcock Institute</span>
                              <input type="checkbox"  name="Newsletters" id=Newsletters__ID value='newsletters' >
                          <div class="control_indicator"></div>
                      </label>
                      <span id=quest__ID ><br>Have you been diagnosed with, or think you have?</span>
                      <label class="control control-checkbox">Asthma
                          <input type="checkbox"  name="Asthma" value="Asthma" id="Asthma__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">COPD (Chronic Obstructive Pulmonary Disease)
                          <input type="checkbox"  name="COPD" value="COPD" id="COPD__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">Chronic Bronchitis
                          <input type="checkbox"  name="Chronic_Bronchitis" value="Chronic Bronchitis" id="Chronic_Bronchitis__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">Emphysema
                          <input type="checkbox"  name="Emphysema" value="Emphysema" id="Emphysema__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">Rhintis
                          <input type="checkbox"  name="Rhintis" value="Rhintis" id="Rhintis__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">Lung Cancer
                          <input type="checkbox"  name="Lung_Cancer" value="Lung Cancer" id="Lung_Cancer__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">Insomnia
                          <input type="checkbox"  name="Insomnia" value="Insomnia" id="Insomnia__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">Narcolepsy
                          <input type="checkbox"  name="Narcolepsy" value="Narcolepsy" id="Narcolepsy__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">OSA (Obstructive Sleep Apnoea)
                          <input type="checkbox"  name="OSA" value="OSA" id="OSA__ID" />
                          <div class="control_indicator"></div>
                      </label>
                      <label class="control control-checkbox">RLS (Restless Leg Syndrome)
                          <input type="checkbox"  name="RLS" value=RLS id="RLS__ID" />
                          <div class="control_indicator"></div>
                      </label>

                  </div>
              </div>
			  <br>
			  <br>
              <input class="btn btn-primary btn-lg" type=button id=submit__ID value="Register" />
		</div>
        <div style='text-align:center;font-size:8pt'>
            <br>
            The Woolcock Institute of Medical Research recognises the importance of your personal information and privacy. <br>
            We will use your provided details only to contact you about information we believe will be of interest to you. <br>
            <a href="https://static1.squarespace.com/static/515ba920e4b0afec12175c59/t/59f019fa29f187a715e74ca6/1508907516135/PrivacyPolicy.pdf" target="_blank" >Click here to read our full Privacy Policy.</a>
        </div>
	</div>

</div>
<script>
    function F__ID(){
        //----------------------------------------
        $('#D__ID').on('load',function(){
            //$('#F__ID')[0].reset();
			$('#submit__ID').show();
        })
        //-------------------------------------
        $('#submit__ID').on('click',function(){
            var record={}
            record.First_Name=$('#First_Name__ID').val();
            record.Last_Name=$('#Last_Name__ID').val();
            record.Phone=$('#Phone__ID').val();
            record.Postcode=$('#Postcode__ID').val();
            record.Email=$('#Email__ID').val();
            record.Gender=$('#Gender__ID').val();
            record.Year_of_Birth=$('#Year_of_Birth__ID').val();

            if($('#Asthma__ID').is(':checked'))             record.Asthma="1"; else record.Asthma='0'
            if($('#COPD__ID').is(':checked'))               record.COPD="1"; else record.COPD='0'
            if($('#Chronic_Bronchitis__ID').is(':checked')) record.Chronic_Bronchitis="1"; else record.Chronic_Bronchitis='0'
            if($('#Emphysema__ID').is(':checked'))          record.Emphysema="1"; else record.Emphysema='0'
            if($('#Rhintis__ID').is(':checked'))            record.Rhintis="1"; else record.Rhintis='0'
            if($('#Lung_Cancer__ID').is(':checked'))        record.Lung_Cancer="1"; else record.Lung_Cancer='0'
            if($('#Insomnia__ID').is(':checked'))           record.Insomnia="1"; else record.Insomnia='0'
            if($('#Narcolepsy__ID').is(':checked'))         record.Narcolepsy="1"; else record.Narcolepsy='0'
            if($('#OSA__ID').is(':checked'))                record.OSA="1"; else record.OSA='0'
            if($('#RLS__ID').is(':checked'))                record.RLS="1"; else record.RLS='0'
            if($('#Medical_Research__ID').is(':checked'))   record.Medical_Research="1"; else record.Medical_Research='0'
            if($('#Newsletters__ID').is(':checked'))        record.Newsletters="1"; else record.Newsletters='0'
            if($('#Medical_Research__ID').is(':checked')==true) {
                if($('#First_Name__ID').val()===''){
                    $vm.alert("First Name is compulsory");
                    return;
                }
                if($('#Last_Name__ID').val()===''){
                    $vm.alert("Last Name is compulsory");
                    return;
                }
                if($('#Phone__ID').val()===''){
                    $vm.alert("Phone is compulsory");
                    return;
                }
                if($('#Postcode__ID').val()===''){
                    $vm.alert("Postcode is compulsory");
                    return;
                }
                var re=/^(\d{4})$/;
                if(re.test($('#Postcode__ID').val())===false){
                    $vm.alert("Post code: 4 digits Please");
                    return;
                }
                if($('#Gender__ID').val()===''){
                    $vm.alert("Gender is compulsory");
                    return;
                }
                if($('#Year_of_Birth__ID').val()===''){
                    $vm.alert("Year of Birth is compulsory");
                    return;
                }
				if((new Date).getFullYear()-parseInt($('#Year_of_Birth__ID').val())<18){
					$vm.alert("Sorry, minimum age is 18");
					return;
				}
				var re=/^(19\d\d|20[0-1]\d)$/;
                if(re.test($('#Year_of_Birth__ID').val())===false){
					$vm.alert("Year of Birth: 19nn to 20nn");
                    return;
                }
            }
            if($('#Email__ID').val()===''){
                $vm.alert("Email is compulsory");
                return;
            }
            var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            if(re.test($('#Email__ID').val())===false){
                $vm.alert("Invalid email format");
                return;
            }
            if($('#Registration_Password__ID').val()===''){
                $vm.alert("Password is compulsory");
                return;
            }
            if($('#Medical_Research__ID').is(':checked')==false && $('#Newsletters__ID').is(':checked')==false){
                $vm.alert("Please select one or both of the check boxes at the top of the registration page.  This gives us your consent to send a newsletter or contact you about our research.");
                return;
            };
            var dbv={};
            dbv.S1=$('#Email__ID').val();
            dbv.S2=$('#Email__ID').val();
            dbv.ES3=$('#Registration_Password__ID').val();
            var req={cmd:"s1_s2_exist",db_pid:'20008533',s1:dbv.S1,s2:dbv.S2};
            $VmAPI.request({data:req,callback:function(res){
                if(res.ret==='0'){
					dbv.DT1=$('#Year_of_Birth__ID').val()+"-01-01";
				   	dbv.B1=record.Medical_Research;
				   	var g1=0; if(record.Gender=='Male') g1=1;
				   	var g2=0; if(record.Gender=='Female') g2=1;
				   	var s=parseInt(record.Asthma)+2*parseInt(record.COPD)+4*parseInt(record.Chronic_Bronchitis)+8*parseInt(record.Emphysema)+16*parseInt(record.Rhintis);
				   	s+=32*parseInt(record.Lung_Cancer)+64*parseInt(record.Insomnia)+128*parseInt(record.Narcolepsy)+256*parseInt(record.OSA)+512*parseInt(record.RLS)+1024*parseInt(g1)+2048*parseInt(g2);
				   	dbv.V1=s;
				   	dbv.V2=record.Postcode;
                    var req={cmd:"add_record",db_pid:'20008533',data:record,dbv:dbv}; //geust can add
                    $VmAPI.request({data:req,callback:function(res){
						$('#submit__ID').hide();
                        send_email();
                    }});
                }
                else{
                    alert('The username or email already exists.')
                }
            }});
        })
        //-------------------------------------
        var send_email=function(){
            var From_Address="noresponse@woolcock.org.au";
            var From_Name="Woolcock Institute of Medical Research";
            var To=$('#Email__ID').val();
            var Title="Registration";
			var Body="Thank you for agreeing to volunteer to participate in research at the Woolcock Institute of Medical Research.<br><br>"
            Body+="If you need to contact us in relation to the information we hold about you please call 02 9114 0412 or email admin@woolcock.org.au.<br><br>"
            Body+="The information you have provided to us has been added to our Volunteer Database. We have asked you for the minimum amount of information we need to identify if you might be eligible for a project.<br><br>"
            Body+="The Woolcock is a world-class network of specialised researchers and clinicians who deal with the causes, prevention, diagnosis and treatment of respiratory disease and sleep disorders. We use the database to recruit volunteers for research projects.<br><br>"
            Body+="Woolcock researchers who have been granted permission to use the database will search according to the criteria of their project to identify suitable volunteers. If you are selected a researcher will contact you directly. They may ask you further questions to identify if you are eligible for that project. At any time in the process you can withdraw or decline to participate in any particular project or ask to be removed from the database.<br><br>"
            Body+="We will not disclose the information on the Volunteer Database to anyone other than Woolcock researchers with an approved project that is being conducted under the supervision of the Woolcock. All projects will have been approved by a properly constituted ethic committee and will be conducted under the Australian Code for Responsible Conduct of Research published by the NHMRC.<br><br>"
            Body+="To view the Woolcockâ€™s Privacy Policy Visit Woolcock.org.au.<br><br>"
            Body+="You can update your details at any time by visiting <a href='https://volunteer-database.rt.org.au/'>https://volunteer-database.rt.org.au/</a><br><br>";
            Body+="Thank you again for volunteering to help us in our research.<br><br>"
            Body+="Professor Carol Armour<br>"
            Body+="Executive Director<br>"
            Body+="Woolcock Institute of Medical Research<br>"
            $VmAPI.request({data:{cmd:'send_email',From_Address:From_Address,From_Name:From_Name,To:To,Title:Title,Body:Body},callback:function(res){
				$vm.nav_load_module('panel_main_registration_thanks');
				/*
				if($('#Newsletters__ID').is(':checked')==true & $('#Medical_Research__ID').is(':checked')==false){
					$vm.nav_load_module('panel_main_registration_thanks');
				}
				else{
					//copy username and password to the signin section and trigger a click
					$vm.nav_load_module('panel_main_signin',$vm.root_layout_content_slot,{email:$('#Email__ID').val(),pw:$('#Registration_Password__ID').val()});
				}
				*/
            }})
        }
    }
</script>
<style>
#D__ID{
	height:100%;
	overflow:auto;
	animation: vm_module_fadein 1.0s;
	background:rgba(255,255,255,0.2);
}
	#page__ID{
		height:100%;
		display: flex;
		align-items: center;
	}
	.panel__ID{
		color:#000;
		font-weight: normal;
		background: rgba(255,255,255,0.8);
		padding: 30px 20px 10px 20px;
		border-radius: 15px;
	}
	@media screen and (max-width:786px){
		#page__ID{
			display: block;
		}
	}
    #panel__ID li{
		cursor:pointer;
	}
    .control {
        font-family: arial;
        display: block;
        position: relative;
        padding-left: 30px;
        margin-bottom: 5px;
        padding-top: 3px;
        cursor: pointer;
        font-size: 16px;
    }
    .control {
        font-family: arial;
        display: block;
        position: relative;
        padding-left: 30px;
        margin-bottom: 5px;
        padding-top: 3px;
        cursor: pointer;
        font-size: 16px;
    }
        .control input {
            position: absolute;
            z-index: -1;
            opacity: 0;
        }
    .control_indicator {
        position: absolute;
        top: 2px;
        left: 0;
        height: 20px;
        width: 20px;
        background: #e6e6e6;
        border: 1px solid #000000;
    }
    .control-radio .control_indicator {
        border-radius: 50%;
    }
    .control:hover input ~ .control_indicator,
    .control input:focus ~ .control_indicator {
        background: #cccccc;
    }

    .control input:checked ~ .control_indicator {
        background: #A51C3D;
    }
    .control:hover input:not([disabled]):checked ~ .control_indicator,
    .control input:checked:focus ~ .control_indicator {
        background: #0e6647d;
    }
    .control input:disabled ~ .control_indicator {
        background: #e6e6e6;
        opacity: 0.6;
        pointer-events: none;
    }
    .control_indicator:after {
        box-sizing: unset;
        content: '';
        position: absolute;
        display: none;
    }
    .control input:checked ~ .control_indicator:after {
        display: block;
    }
    .control-radio .control_indicator:after {
        left: 7px;
        top: 7px;
        height: 0px;
        width: 0px;
        border-radius: 50%;
        background: #ffffff;
    }
    .control-radio input:disabled ~ .control_indicator:after {
        background: #7b7b7b;
    }
    .control-checkbox .control_indicator {
        border-radius: 10%;
    }
    .control-checkbox .control_indicator:after {
        left: 8px;
        top: 4px;
        width: 3px;
        height: 8px;
        border: solid #ffffff;
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
    }
    .control-checkbox input:disabled ~ .control_indicator:after {
        border-color: #7b7b7b;
    }

</style>
